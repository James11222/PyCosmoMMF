<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="PyCosmoMMF" href="index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
    <title>
      Basic Use - pycosmommf 0.1.3.dev4+gd17e420.d20241114 documentation
    </title>
    <link
      rel="stylesheet"
      type="text/css"
      href="_static/pygments.css?v=a746c00c"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="_static/styles/furo.css?v=354aac6f"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="_static/copybutton.css?v=76b2166b"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="_static/styles/furo-extensions.css?v=302659d7"
    />

    <style>
      body {
        --color-code-background: #f8f8f8;
        --color-code-foreground: black;
      }
      @media not print {
        body[data-theme="dark"] {
          --color-code-background: #202020;
          --color-code-foreground: #d0d0d0;
        }
        @media (prefers-color-scheme: dark) {
          body:not([data-theme="light"]) {
            --color-code-background: #202020;
            --color-code-foreground: #d0d0d0;
          }
        }
      }
    </style>
  </head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>

    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg
          stroke="currentColor"
          fill="currentColor"
          stroke-width="0"
          viewBox="0 0 1024 1024"
        >
          <path
            d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"
          />
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather-menu"
        >
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather-chevron-right"
        >
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-sun" viewBox="0 0 24 24">
        <title>Light mode</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather-sun"
        >
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
      </symbol>
      <symbol id="svg-moon" viewBox="0 0 24 24">
        <title>Dark mode</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon-tabler-moon"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path
            d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"
          />
        </svg>
      </symbol>
      <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
        <title>Auto light/dark, in light mode</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon-custom-derived-from-feather-sun-and-tabler-moon"
        >
          <path
            style="opacity: 50%"
            d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"
          />
          <line x1="14.5" y1="3.25" x2="14.5" y2="1.25" />
          <line x1="14.5" y1="15.85" x2="14.5" y2="17.85" />
          <line x1="10.044" y1="5.094" x2="8.63" y2="3.68" />
          <line x1="19" y1="14.05" x2="20.414" y2="15.464" />
          <line x1="8.2" y1="9.55" x2="6.2" y2="9.55" />
          <line x1="20.8" y1="9.55" x2="22.8" y2="9.55" />
          <line x1="10.044" y1="14.006" x2="8.63" y2="15.42" />
          <line x1="19" y1="5.05" x2="20.414" y2="3.636" />
          <circle cx="14.5" cy="9.55" r="3.6" />
        </svg>
      </symbol>
      <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
        <title>Auto light/dark, in dark mode</title>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon-custom-derived-from-feather-sun-and-tabler-moon"
        >
          <path
            d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"
          />
          <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5" />
          <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5" />
          <line
            style="opacity: 50%"
            x1="15.316"
            y1="4.816"
            x2="14.464"
            y2="3.964"
          />
          <line
            style="opacity: 50%"
            x1="20.711"
            y1="10.212"
            x2="21.563"
            y2="11.063"
          />
          <line
            style="opacity: 50%"
            x1="14.205"
            y1="7.5"
            x2="13.001"
            y2="7.5"
          />
          <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5" />
          <line
            style="opacity: 50%"
            x1="15.316"
            y1="10.184"
            x2="14.464"
            y2="11.036"
          />
          <line
            style="opacity: 50%"
            x1="20.711"
            y1="4.789"
            x2="21.563"
            y2="3.937"
          />
          <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169" />
        </svg>
      </symbol>
      <symbol id="svg-pencil" viewBox="0 0 24 24">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon-tabler-pencil-code"
        >
          <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
          <path d="M13.5 6.5l4 4" />
          <path d="M20 21l2 -2l-2 -2" />
          <path d="M17 17l-2 2l2 2" />
        </svg>
      </symbol>
      <symbol id="svg-eye" viewBox="0 0 24 24">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon-tabler-eye-code"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
          <path
            d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008"
          />
          <path d="M20 21l2 -2l-2 -2" />
          <path d="M17 17l-2 2l2 2" />
        </svg>
      </symbol>
    </svg>

    <input
      type="checkbox"
      class="sidebar-toggle"
      name="__navigation"
      id="__navigation"
    />
    <input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" />
    <label class="overlay sidebar-overlay" for="__navigation">
      <div class="visually-hidden">Hide navigation sidebar</div>
    </label>
    <label class="overlay toc-overlay" for="__toc">
      <div class="visually-hidden">Hide table of contents sidebar</div>
    </label>

    <a class="skip-to-content muted-link" href="#furo-main-content"
      >Skip to content</a
    >

    <div class="page">
      <header class="mobile-header">
        <div class="header-left">
          <label class="nav-overlay-icon" for="__navigation">
            <div class="visually-hidden">Toggle site navigation sidebar</div>
            <i class="icon"
              ><svg><use href="#svg-menu"></use></svg
            ></i>
          </label>
        </div>
        <div class="header-center">
          <a href="index.html"
            ><div class="brand">
              pycosmommf 0.1.3.dev4+gd17e420.d20241114 documentation
            </div></a
          >
        </div>
        <div class="header-right">
          <div class="theme-toggle-container theme-toggle-header">
            <button class="theme-toggle">
              <div class="visually-hidden">
                Toggle Light / Dark / Auto color theme
              </div>
              <svg class="theme-icon-when-auto-light">
                <use href="#svg-sun-with-moon"></use>
              </svg>
              <svg class="theme-icon-when-auto-dark">
                <use href="#svg-moon-with-sun"></use>
              </svg>
              <svg class="theme-icon-when-dark">
                <use href="#svg-moon"></use>
              </svg>
              <svg class="theme-icon-when-light">
                <use href="#svg-sun"></use>
              </svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"
              ><svg><use href="#svg-toc"></use></svg
            ></i>
          </label>
        </div>
      </header>
      <aside class="sidebar-drawer">
        <div class="sidebar-container">
          <div class="sidebar-sticky">
            <a class="sidebar-brand" href="index.html">
              <div class="sidebar-logo-container">
                <img
                  class="sidebar-logo only-light"
                  src="_static/CosmoMMF_light.png"
                  alt="Light Logo"
                />
                <img
                  class="sidebar-logo only-dark"
                  src="_static/CosmoMMF_Dark.png"
                  alt="Dark Logo"
                />
              </div>

              <span class="sidebar-brand-text"
                >pycosmommf 0.1.3.dev4+gd17e420.d20241114 documentation</span
              >
            </a>
            <form
              class="sidebar-search-container"
              method="get"
              action="search.html"
              role="search"
            >
              <input
                class="sidebar-search"
                placeholder="Search"
                name="q"
                aria-label="Search"
              />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
            <div id="searchbox"></div>
            <div class="sidebar-scroll">
              <div class="sidebar-tree">
                <ul class="current">
                  <li class="toctree-l1 current current-page">
                    <a class="current reference internal" href="#">Basic Use</a>
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="#general-code-usage"
                      >General Code Usage</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </aside>
      <div class="main">
        <div class="content">
          <div class="article-container">
            <a href="#" class="back-to-top muted-link">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                  d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"
                ></path>
              </svg>
              <span>Back to top</span>
            </a>
            <div class="content-icon-container">
              <div class="view-this-page">
                <a
                  class="muted-link"
                  href="_sources/test.md.txt"
                  title="View this page"
                >
                  <svg><use href="#svg-eye"></use></svg>
                  <span class="visually-hidden">View this page</span>
                </a>
              </div>
              <div class="theme-toggle-container theme-toggle-content">
                <button class="theme-toggle">
                  <div class="visually-hidden">
                    Toggle Light / Dark / Auto color theme
                  </div>
                  <svg class="theme-icon-when-auto-light">
                    <use href="#svg-sun-with-moon"></use>
                  </svg>
                  <svg class="theme-icon-when-auto-dark">
                    <use href="#svg-moon-with-sun"></use>
                  </svg>
                  <svg class="theme-icon-when-dark">
                    <use href="#svg-moon"></use>
                  </svg>
                  <svg class="theme-icon-when-light">
                    <use href="#svg-sun"></use>
                  </svg>
                </button>
              </div>
              <label
                class="toc-overlay-icon toc-content-icon no-toc"
                for="__toc"
              >
                <div class="visually-hidden">
                  Toggle table of contents sidebar
                </div>
                <i class="icon"
                  ><svg><use href="#svg-toc"></use></svg
                ></i>
              </label>
            </div>
            <article role="main" id="furo-main-content">
              <section id="basic-use">
                <h1>
                  Basic Use<a
                    class="headerlink"
                    href="#basic-use"
                    title="Link to this heading"
                    >¶</a
                  >
                </h1>
                <p>
                  Nexus Pipeline for analyzing the effects of baryonic matter on
                  cosmological structures in IllustrisTNG simulations
                </p>
                <p>
                  The
                  <code class="docutils literal notranslate"
                    ><span class="pre">PyCosmoMMF</span></code
                  >
                  package contains the algorithms necessary for a Multiscale
                  Morphological Analysis (MMF) of cosmological simulations. The
                  purpose of this package is to streamline our modified version
                  of the NEXUS+ algorithm. We used the
                  <code class="docutils literal notranslate"
                    ><span class="pre">julia</span></code
                  >
                  version of this package in our work (<a
                    class="reference external"
                    href="https://ui.adsabs.harvard.edu/abs/2023PhRvD.107b3514S/abstract"
                    >Sunseri et al. 2022</a
                  >) to analyze the effects of baryonic matter on the Cosmic
                  Web.
                </p>
                <p>
                  The NEXUS+ algorithm contains several steps as described in
                  our paper (<a
                    class="reference external"
                    href="https://ui.adsabs.harvard.edu/abs/2023PhRvD.107b3514S/abstract"
                    >Sunseri et al. 2022</a
                  >). In general, we start with a density field (note: we more
                  specifically mean a 1 + δ field), smooth it with a logarithmic
                  Gaussian smoothing filter, then compute the hessian of the
                  smoothed density field, use the eigenvalues of the hessian
                  matrix to calculate the structure type signatures, find the
                  maximum signatures over a range of smoothing scales, and apply
                  physically based threshold criterion to categorize structures
                  within the Cosmic Web. The entire package is implemented in
                  <code class="docutils literal notranslate"
                    ><span class="pre">python</span></code
                  >
                  and all of these steps are summarized inside of two functions.
                  The first function
                  <code class="docutils literal notranslate"
                    ><span class="pre">maximum_signature()</span></code
                  >
                  does the first several steps of the NEXUS+ algorithm to
                  compute the maximum structure signatures, the second function
                  is
                  <code class="docutils literal notranslate"
                    ><span class="pre">calc_structure_bools()</span></code
                  >
                  which uses physical criteria to tag structures into 4
                  categories: clusters, filaments, walls, and voids.
                </p>
                <p>
                  We also make the data products from our paper (<a
                    class="reference external"
                    href="https://ui.adsabs.harvard.edu/abs/2023PhRvD.107b3514S/abstract"
                    >Sunseri et al. 2022</a
                  >) available for download at
                  <a
                    class="reference external"
                    href="http://idark.ipmu.jp/~jia.liu/data/Baryon_Analysis_Data/"
                    >This Link</a
                  >
                </p>
              </section>
              <section id="general-code-usage">
                <h1>
                  General Code Usage<a
                    class="headerlink"
                    href="#general-code-usage"
                    title="Link to this heading"
                    >¶</a
                  >
                </h1>
                <p>The general usage of the package would look like:</p>
                <section id="step-i">
                  <h2>
                    Step I<a
                      class="headerlink"
                      href="#step-i"
                      title="Link to this heading"
                      >¶</a
                    >
                  </h2>
                  <p>
                    We first calculate the maximum structure signatures across
                    multiple smoothing scales with the NEXUS+/NEXUS algorithm
                  </p>
                  <div class="highlight-python notranslate">
                    <div class="highlight">
                      <pre><span></span>
<span class="kn">import</span> <span class="nn">PyCosmoMMF</span>

<span class="n">density_field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;path/to/density_field.npy&quot;</span><span class="p">)</span>

<span class="n">Rs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1">#smoothing scales</span>

<span class="n">max_signatures</span> <span class="o">=</span> <span class="n">PyCosmoMMF</span><span class="o">.</span><span class="n">maximum_signature</span><span class="p">(</span><span class="n">Rs</span><span class="p">,</span> <span class="n">density_field</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;NEXUSPLUS&quot;</span><span class="p">)</span> <span class="c1">#compute maximum signatures</span>

</pre>
                    </div>
                  </div>
                  <p>
                    The output of
                    <code class="docutils literal notranslate"
                      ><span class="pre">maximum_signature()</span></code
                    >
                    is a 4D Float Array where the 4th index denotes the
                    signature type: 0 = clusters, 1 = filaments, 2 = walls. An
                    example output of this can be seen below
                  </p>
                  <!-- <p align="center">

<img src="Images/final_NEXUSPLUS_Signatures_hydro_dark.png#gh-dark-mode-only" width="100%">

<img src="Images/final_NEXUSPLUS_Signatures_hydro.png#gh-light-mode-only" width="100%">

</p> -->
                </section>
                <section id="step-ii">
                  <h2>
                    Step II<a
                      class="headerlink"
                      href="#step-ii"
                      title="Link to this heading"
                      >¶</a
                    >
                  </h2>
                  <p>
                    We then have the option of running the tagging scheme a few
                    different ways. The first important argument in
                    <code class="docutils literal notranslate"
                      ><span class="pre">calc_structure_bools()</span></code
                    >
                    besides the
                    <code class="docutils literal notranslate"
                      ><span class="pre">density_field</span></code
                    >
                    and the
                    <code class="docutils literal notranslate"
                      ><span class="pre">max_signatures</span></code
                    >
                    arrays is the
                    <code class="docutils literal notranslate"
                      ><span class="pre">verbose_flag</span></code
                    >. When
                  </p>
                  <p>
                    set to
                    <code class="docutils literal notranslate"
                      ><span class="pre">True</span></code
                    >
                    the code gives a lot more information and provides a few
                    plots. This is best turned on when
                  </p>
                  <p>
                    debugging the code. When
                    <code class="docutils literal notranslate"
                      ><span class="pre">verbose_flag</span></code
                    >
                    is turned on there are 4 additional outputs to the
                    <code class="docutils literal notranslate"
                      ><span class="pre">calc_structure_bools()</span></code
                    >
                  </p>
                  <p>
                    function:
                    <code class="docutils literal notranslate"
                      ><span class="pre">S_fil,</span>
                      <span class="pre">dM2_fil,</span>
                      <span class="pre">S_wall,</span>
                      <span class="pre">dM2_wall</span></code
                    >
                    which can be used to make the mass change curves for
                    filaments and
                  </p>
                  <p>walls.</p>
                  <p>
                    <em><strong>Verbose Flag On:</strong></em>
                  </p>
                  <div class="highlight-python notranslate">
                    <div class="highlight">
                      <pre><span></span>
<span class="n">verbose_flag</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">#or False</span>


<span class="n">clusbool</span><span class="p">,</span> <span class="n">filbool</span><span class="p">,</span> <span class="n">wallbool</span><span class="p">,</span> <span class="n">voidbool</span><span class="p">,</span> <span class="n">S_fil</span><span class="p">,</span> <span class="n">dM2_fil</span><span class="p">,</span> <span class="n">S_wall</span><span class="p">,</span> <span class="n">dM2_wall</span> <span class="o">=</span> <span class="n">PyCosmoMMF</span><span class="o">.</span><span class="n">calc_structure_bools</span><span class="p">(</span>

                                                       <span class="n">density_field</span><span class="p">,</span> <span class="n">max_signatures</span><span class="p">,</span> <span class="n">verbose_flag</span><span class="p">)</span> <span class="c1">#tag structures</span>

</pre>
                    </div>
                  </div>
                  <p>
                    <em><strong>Verbose Flag Off:</strong></em>
                  </p>
                  <div class="highlight-python notranslate">
                    <div class="highlight">
                      <pre><span></span>
<span class="n">verbose_flag</span> <span class="o">=</span> <span class="kc">False</span>


<span class="n">clusbool</span><span class="p">,</span> <span class="n">filbool</span><span class="p">,</span> <span class="n">wallbool</span><span class="p">,</span> <span class="n">voidbool</span> <span class="o">=</span> <span class="n">PyCosmoMMF</span><span class="o">.</span><span class="n">calc_structure_bools</span><span class="p">(</span>

                                        <span class="n">density_field</span><span class="p">,</span> <span class="n">max_signatures</span><span class="p">,</span> <span class="n">verbose_flag</span><span class="p">)</span> <span class="c1">#tag structures</span>

</pre>
                    </div>
                  </div>
                  <p>
                    We also note in the
                    <code class="docutils literal notranslate"
                      ><span class="pre">calc_structure_bools()</span></code
                    >
                    function, one can use their own cluster boolean filter
                    instead of the one generated by the NEXUS+ formalism (using
                    virialization of clusters as a tool for determining spurious
                    detections). This is helpful if you want to use a more
                    trusted cluster/halo finder algorithm (FoF, Rockstar, etc…).
                    For more information on the NEXUS+ method, see
                    <a
                      class="reference external"
                      href="https://academic.oup.com/mnras/article/429/2/1286/1038906"
                      >Cautun et al. 2013</a
                    >.
                  </p>
                  <p>
                    <em><strong>External Cluster Boolean Filter:</strong></em>
                  </p>
                  <div class="highlight-python notranslate">
                    <div class="highlight">
                      <pre><span></span>
<span class="n">clusbool_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;path/to/cluster_boolean_filter.npy&quot;</span><span class="p">)</span><span class="c1">#load in externally computed boolean filter for clusters</span>

<span class="n">verbose_flag</span> <span class="o">=</span> <span class="kc">False</span>


<span class="n">clusbool</span><span class="p">,</span> <span class="n">filbool</span><span class="p">,</span> <span class="n">wallbool</span><span class="p">,</span> <span class="n">voidbool</span> <span class="o">=</span> <span class="n">PyCosmoMMF</span><span class="o">.</span><span class="n">calc_structure_bools</span><span class="p">(</span>
                                        <span class="n">density_field</span><span class="p">,</span> <span class="n">max_signatures</span><span class="p">,</span> <span class="n">verbose_flag</span><span class="p">,</span> <span class="n">clusbool_ext</span><span class="p">)</span> <span class="c1">#tag structures</span>

</pre>
                    </div>
                  </div>
                  <p>
                    Another important optional argument in the
                    <code class="docutils literal notranslate"
                      ><span class="pre">calc_structure_bools()</span></code
                    >
                    function is
                    <code class="docutils literal notranslate"
                      ><span class="pre">Δ</span></code
                    >. The default value is
                    <code class="docutils literal notranslate"
                      ><span class="pre">Δ</span> <span class="pre">=</span>
                      <span class="pre">370</span></code
                    >
                    as used in
                    <a
                      class="reference external"
                      href="https://academic.oup.com/mnras/article/429/2/1286/1038906"
                      >Cautun et al. 2013</a
                    >
                    but other values can be 200 or 500 corresponding to
                    <code class="docutils literal notranslate"
                      ><span class="pre">R_200</span></code
                    >
                    or
                    <code class="docutils literal notranslate"
                      ><span class="pre">R_500</span></code
                    >.
                    <code class="docutils literal notranslate"
                      ><span class="pre">Δ</span></code
                    >
                    is the overdensity parameter, when clusters achieve a
                    density greater than this value, they are thought to be
                    virialized/collapsed.
                  </p>
                  <p>
                    The boolean filters for each structure type produced by
                    <code class="docutils literal notranslate"
                      ><span class="pre">calc_structure_bools()</span></code
                    >
                    can be used to tag structures within a density field, the
                    results of this can be seen below
                  </p>
                  <!-- <p align="center">

<img src="final_tagging_figure_dark.png#gh-dark-mode-only" width="100%">

<img src="final_tagging_figure.png#gh-light-mode-only" width="100%">

</p> -->
                </section>
                <section id="additional-code-information">
                  <h2>
                    Additional Code Information<a
                      class="headerlink"
                      href="#additional-code-information"
                      title="Link to this heading"
                      >¶</a
                    >
                  </h2>
                  <ul class="simple">
                    <li>
                      <p>
                        Note: The NEXUS+ implementation of tagging clusters is
                        highly dependent on the the grid resolution being used.
                        The cluster boolean filter will only be physically
                        motivated if the resolution of each voxel is roughly
                        &lt; 1 Mpc/h so clusters can be resolved.
                      </p>
                    </li>
                  </ul>
                </section>
              </section>
            </article>
          </div>
          <footer>
            <div class="related-pages">
              <a class="prev-page" href="index.html">
                <svg class="furo-related-icon">
                  <use href="#svg-arrow-right"></use>
                </svg>
                <div class="page-info">
                  <div class="context">
                    <span>Previous</span>
                  </div>

                  <div class="title">Home</div>
                </div>
              </a>
            </div>
            <div class="bottom-of-page">
              <div class="left-details">
                <div class="copyright">
                  Copyright &#169; 2024, James Sunseri
                </div>
                Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and
                <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a
                >'s

                <a href="https://github.com/pradyunsg/furo">Furo</a>
              </div>
              <div class="right-details"></div>
            </div>
          </footer>
        </div>
        <aside class="toc-drawer no-toc"></aside>
      </div>
    </div>
    <script src="_static/documentation_options.js?v=27e77f62"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
  </body>
</html>
